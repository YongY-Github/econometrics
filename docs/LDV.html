<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Applied Econometrics Notes - 6&nbsp; Limited Dependent Variable Models and Maximum Likelihood Estimation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./panel.html" rel="next">
<link href="./dummynonlinear.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./LDV.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Limited Dependent Variable Models and Maximum Likelihood Estimation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Econometrics Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simple Regression Model: Basics of OLS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Classical Linear Model (Gauss-Markov) Assumptions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Multiple Regression Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./violationofassumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Violation of CLRM Assumptions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dummynonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Non-linear Models and Dummy Variable Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LDV.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Limited Dependent Variable Models and Maximum Likelihood Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./panel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Panel Data Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#maximum-likelihood-estimation-mle" id="toc-maximum-likelihood-estimation-mle" class="nav-link active" data-scroll-target="#maximum-likelihood-estimation-mle"><span class="header-section-number">6.1</span> Maximum Likelihood Estimation (MLE)</a></li>
  <li><a href="#binary-dependent-variables-logit-and-probit" id="toc-binary-dependent-variables-logit-and-probit" class="nav-link" data-scroll-target="#binary-dependent-variables-logit-and-probit"><span class="header-section-number">6.2</span> Binary Dependent Variables (Logit and Probit)</a>
  <ul class="collapse">
  <li><a href="#the-linear-probability-model-lpm-and-its-problems" id="toc-the-linear-probability-model-lpm-and-its-problems" class="nav-link" data-scroll-target="#the-linear-probability-model-lpm-and-its-problems"><span class="header-section-number">6.2.1</span> The Linear Probability Model (LPM) and its Problems</a></li>
  <li><a href="#the-latent-variable-framework" id="toc-the-latent-variable-framework" class="nav-link" data-scroll-target="#the-latent-variable-framework"><span class="header-section-number">6.2.2</span> The Latent Variable Framework</a></li>
  <li><a href="#logit-and-probit-models" id="toc-logit-and-probit-models" class="nav-link" data-scroll-target="#logit-and-probit-models"><span class="header-section-number">6.2.3</span> Logit and Probit Models</a></li>
  </ul></li>
  <li><a href="#multinomial-and-ordered-models" id="toc-multinomial-and-ordered-models" class="nav-link" data-scroll-target="#multinomial-and-ordered-models"><span class="header-section-number">6.3</span> Multinomial and Ordered Models</a></li>
  <li><a href="#censored-and-truncated-regression-tobit-model" id="toc-censored-and-truncated-regression-tobit-model" class="nav-link" data-scroll-target="#censored-and-truncated-regression-tobit-model"><span class="header-section-number">6.4</span> Censored and Truncated Regression (Tobit Model)</a></li>
  <li><a href="#count-data-models-poisson-regression" id="toc-count-data-models-poisson-regression" class="nav-link" data-scroll-target="#count-data-models-poisson-regression"><span class="header-section-number">6.5</span> Count Data Models (Poisson Regression)</a></li>
  <li><a href="#sample-selection-models-heckmans-heckit" id="toc-sample-selection-models-heckmans-heckit" class="nav-link" data-scroll-target="#sample-selection-models-heckmans-heckit"><span class="header-section-number">6.6</span> Sample Selection Models (Heckman’s Heckit)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Limited Dependent Variable Models and Maximum Likelihood Estimation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>When the dependent variable (Y) is limited in its range (e.g., binary, count data, or censored), Ordinary Least Squares (OLS) is often inappropriate. This chapter introduces Maximum Likelihood Estimation (MLE) and the family of models designed for such limited dependent variables.</p>
<section id="maximum-likelihood-estimation-mle" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="maximum-likelihood-estimation-mle"><span class="header-section-number">6.1</span> Maximum Likelihood Estimation (MLE)</h2>
<p>OLS is not the only method for estimating parameters. MLE is another powerful and widely used estimator.</p>
<ul>
<li><strong>Concept:</strong> Maximum Likelihood Estimation finds the parameter values that make the observed sample data <strong>most probable</strong> (i.e., maximize the likelihood function).</li>
<li><strong>Intuition:</strong> Given a statistical model (e.g., a normal distribution) and a sample of data, MLE answers: “What values of the model’s parameters (mean, variance) would most likely have generated this data?”</li>
<li><strong>Comparison:</strong> While OLS minimizes the sum of squared residuals, MLE maximizes the likelihood function. For the classical linear model with normal errors, OLS and MLE produce identical estimates.</li>
</ul>
<p>Let’s explore some important LDV models, i.e.&nbsp;models in which dependent variable can assume a limited form, making linear regression unsuitable.</p>
</section>
<section id="binary-dependent-variables-logit-and-probit" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="binary-dependent-variables-logit-and-probit"><span class="header-section-number">6.2</span> Binary Dependent Variables (Logit and Probit)</h2>
<p>When the outcome is binary, e.g., <span class="math inline">\(Y_i = \{1, 0\}\)</span> (e.g., 1=owns a car, 0=does not own a car).</p>
<section id="the-linear-probability-model-lpm-and-its-problems" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="the-linear-probability-model-lpm-and-its-problems"><span class="header-section-number">6.2.1</span> The Linear Probability Model (LPM) and its Problems</h3>
<p>A naive approach is to use OLS on the binary outcome: <span class="math inline">\(Y_i = \beta_1 + \beta_2 X_{2i} + u_i\)</span>. - The fitted values, <span class="math inline">\(\hat{Y}_i\)</span>, can be interpreted as the probability that <span class="math inline">\(Y_i=1\)</span>. - <strong>Problems:</strong> 1. <strong>Probabilities outside [0,1]:</strong> OLS can predict probabilities less than 0 or greater than 1. 2. <strong>Non-normal errors:</strong> The error term <span class="math inline">\(u_i\)</span> can only take two values, violating the normality assumption. 3. <strong>Heteroskedasticity:</strong> The variance of the error term is not constant. 4. <strong>Low R²:</strong> R-squared is often very low for cross-sectional binary outcomes, which is not a good measure of fit.</p>
</section>
<section id="the-latent-variable-framework" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="the-latent-variable-framework"><span class="header-section-number">6.2.2</span> The Latent Variable Framework</h3>
<p>A better approach is to model a continuous, unobserved (latent) variable <span class="math inline">\(Y_i^*\)</span> that determines the observed outcome.</p>
<ul>
<li><strong>Latent Model:</strong> <span class="math inline">\(Y_i^* = \beta_1 + \beta_2 X_{2i} + u_i\)</span></li>
<li><strong>Observation Rule:</strong> <span class="math inline">\(Y_i = \begin{cases} 1 &amp; \text{if } Y_i^* \geq 0 \\ 0 &amp; \text{if } Y_i^* &lt; 0 \end{cases}\)</span></li>
</ul>
<p>The probability of observing <span class="math inline">\(Y_i=1\)</span> is:</p>
<p><span class="math display">\[
\begin{aligned}
P(Y_i = 1) &amp;= P(Y_i^* \geq 0) \\
&amp;= P(\beta_1 + \beta_2 X_{2i} + u_i \geq 0) \\
&amp;= P(u_i \geq -\mathbf{X}_i'\boldsymbol{\beta}) \\
&amp;= 1 - F(-\mathbf{X}_i'\boldsymbol{\beta}) = F(\mathbf{X}_i'\boldsymbol{\beta})
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(F(\cdot)\)</span> is a cumulative distribution function (CDF). The last equality holds if the distribution of <span class="math inline">\(u_i\)</span> is symmetric around zero (like the normal or logistic).</p>
</section>
<section id="logit-and-probit-models" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="logit-and-probit-models"><span class="header-section-number">6.2.3</span> Logit and Probit Models</h3>
<p>The choice of <span class="math inline">\(F(\cdot)\)</span> gives rise to different models:</p>
<ol type="1">
<li><p><strong>Probit Model:</strong> Uses the <strong>standard normal CDF</strong>, denoted <span class="math inline">\(\Phi(\cdot)\)</span>. <span class="math display">\[
P(Y_i = 1) = \Phi(\mathbf{X}_i'\boldsymbol{\beta})
\]</span></p></li>
<li><p><strong>Logit Model:</strong> Uses the <strong>logistic CDF</strong>. <span class="math display">\[
P(Y_i = 1) = \Lambda(\mathbf{X}_i'\boldsymbol{\beta}) = \frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1 + \exp(\mathbf{X}_i'\boldsymbol{\beta})}
\]</span></p></li>
</ol>
<p>The parameters <span class="math inline">\(\boldsymbol{\beta}\)</span> are estimated by <strong>Maximum Likelihood Estimation (MLE)</strong>.</p>
<section id="interpretation-of-coefficients" class="level4" data-number="6.2.3.1">
<h4 data-number="6.2.3.1" class="anchored" data-anchor-id="interpretation-of-coefficients"><span class="header-section-number">6.2.3.1</span> Interpretation of Coefficients</h4>
<p>Unlike OLS, the coefficients <span class="math inline">\(\beta_k\)</span> do not represent a constant marginal effect. The marginal effect of a change in <span class="math inline">\(X_k\)</span> on the probability <span class="math inline">\(P(Y=1)\)</span> depends on the values of all explanatory variables.</p>
<ul>
<li><p><strong>Probit Marginal Effect:</strong> <span class="math display">\[
\frac{\partial P(Y_i=1)}{\partial X_k} = \phi(\mathbf{X}_i'\boldsymbol{\beta}) \beta_k
\]</span> where <span class="math inline">\(\phi(\cdot)\)</span> is the standard normal probability density function (PDF).</p></li>
<li><p><strong>Logit Marginal Effect:</strong> <span class="math display">\[
\frac{\partial P(Y_i=1)}{\partial X_k} = \Lambda(\mathbf{X}_i'\boldsymbol{\beta})[1-\Lambda(\mathbf{X}_i'\boldsymbol{\beta})] \beta_k
\]</span></p></li>
<li><p><strong>Odds Ratio (Logit):</strong> The logit model can also be interpreted in terms of odds.</p>
<ul>
<li>The <strong>odds</strong> in favor of <span class="math inline">\(Y=1\)</span> are <span class="math inline">\(\frac{P(Y=1)}{P(Y=0)} = \exp(\mathbf{X}_i'\boldsymbol{\beta})\)</span>.</li>
<li>A one-unit change in <span class="math inline">\(X_k\)</span> <strong>multiplies</strong> the odds by <span class="math inline">\(\exp(\beta_k)\)</span>, holding all else constant.</li>
</ul></li>
</ul>
<p><strong>Example in R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a binary variable: 1 if mpg &gt; 20, 0 otherwise</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>high_mpg <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate a Logit Model</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(high_mpg <span class="sc">~</span> wt <span class="sc">+</span> hp, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> mtcars)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = high_mpg ~ wt + hp, family = binomial(link = "logit"), 
    data = mtcars)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)    894.228 365884.162   0.002    0.998
wt            -202.865  84688.218  -0.002    0.998
hp              -2.021    858.062  -0.002    0.998

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 4.3860e+01  on 31  degrees of freedom
Residual deviance: 1.1156e-08  on 29  degrees of freedom
AIC: 6

Number of Fisher Scoring iterations: 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate a Probit Model</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>probit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(high_mpg <span class="sc">~</span> wt <span class="sc">+</span> hp, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>), <span class="at">data =</span> mtcars)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(probit_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = high_mpg ~ wt + hp, family = binomial(link = "probit"), 
    data = mtcars)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)   262.5104 58549.5044   0.004    0.996
wt            -59.6114 13537.6593  -0.004    0.996
hp             -0.5914   137.9606  -0.004    0.997

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 4.3860e+01  on 31  degrees of freedom
Residual deviance: 1.2574e-08  on 29  degrees of freedom
AIC: 6

Number of Fisher Scoring iterations: 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average marginal effects for the logit model</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("margins")</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>margins_logit <span class="ot">&lt;-</span> <span class="fu">margins</span>(logit_model)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(margins_logit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> factor     AME     SE       z      p   lower  upper
     hp -0.0000 0.0000 -0.0001 0.9999 -0.0000 0.0000
     wt -0.0000 0.0009 -0.0000 1.0000 -0.0017 0.0017</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="multinomial-and-ordered-models" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="multinomial-and-ordered-models"><span class="header-section-number">6.3</span> Multinomial and Ordered Models</h2>
<ul>
<li><strong>Multinomial Logit/Probit:</strong> Used when the dependent variable has more than two categories <strong>without a natural ordering</strong> (e.g., choice of transport: walk, car, BTS).</li>
<li><strong>Ordered Logit/Probit:</strong> Used when the categories have a natural order (e.g., exam grades: A, B, C, D). Both are estimated via MLE.</li>
</ul>
</section>
<section id="censored-and-truncated-regression-tobit-model" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="censored-and-truncated-regression-tobit-model"><span class="header-section-number">6.4</span> Censored and Truncated Regression (Tobit Model)</h2>
<p>The Tobit model is used when the dependent variable is <strong>censored</strong>. For example, a variable can be zero for a substantial fraction of the observations but positive for the rest (e.g., hours worked, where some people work 0 hours).</p>
<ul>
<li><strong>Latent Model:</strong> <span class="math inline">\(Y_i^* = \mathbf{X}_i'\boldsymbol{\beta} + u_i\)</span></li>
<li><strong>Observed Rule:</strong> <span class="math inline">\(Y_i = \begin{cases} Y_i^* &amp; \text{if } Y_i^* &gt; 0 \\ 0 &amp; \text{if } Y_i^* \leq 0 \end{cases}\)</span></li>
</ul>
<p>Using OLS on the censored data leads to biased estimates. The Tobit model uses MLE to estimate the parameters, which accounts for both the probability of being censored and the value of the uncensored observations.</p>
<p><strong>Example in R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("AER")</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example using a simulated dataset. 'hours' is censored at 0.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tobit_model &lt;- tobit(hours ~ age + education, data = dataset)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="count-data-models-poisson-regression" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="count-data-models-poisson-regression"><span class="header-section-number">6.5</span> Count Data Models (Poisson Regression)</h2>
<p>When the dependent variable is a count (e.g., number of patents, number of doctor visits), a Poisson regression model is often appropriate.</p>
<ul>
<li>The Poisson probability density function is <span class="math inline">\(P(Y=y) = \frac{e^{-\mu} \mu^y}{y!}\)</span>, where <span class="math inline">\(E(Y) = Var(Y) = \mu\)</span>.</li>
<li>We model the mean <span class="math inline">\(\mu_i\)</span> as <span class="math inline">\(\mu_i = E(Y_i | \mathbf{X}_i) = \exp(\mathbf{X}_i'\boldsymbol{\beta})\)</span>. This ensures the mean is always positive.</li>
<li>Parameters are estimated by MLE.</li>
</ul>
<p><strong>Example in R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Modeling number of awards (a count) in a dataset</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># poisson_model &lt;- glm(awards ~ math + prog, family = poisson, data = data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sample-selection-models-heckmans-heckit" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="sample-selection-models-heckmans-heckit"><span class="header-section-number">6.6</span> Sample Selection Models (Heckman’s Heckit)</h2>
<p>Sample selection bias occurs when the sample is not randomly selected from the population. For example, estimating wages only for people who are employed (a non-random subset).</p>
<ul>
<li>The Heckit model is a two-step procedure:
<ol type="1">
<li><strong>Selection Equation (Probit):</strong> Model the probability of being included in the sample.</li>
<li><strong>Outcome Equation:</strong> Model the outcome of interest, but include a correction term called the <strong>Inverse Mills Ratio (<span class="math inline">\(\lambda\)</span>)</strong> estimated from the first step to control for selection bias.</li>
</ol></li>
<li>This corrects the bias that would occur if the second step were run on the selected sample alone.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./dummynonlinear.html" class="pagination-link" aria-label="Non-linear Models and Dummy Variable Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Non-linear Models and Dummy Variable Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./panel.html" class="pagination-link" aria-label="Panel Data Regression">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Panel Data Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>